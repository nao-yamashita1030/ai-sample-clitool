# 画面詳細設計: 調査結果一覧画面

## 基本情報

- **画面名**: 調査結果一覧画面
- **画面ID**: SCREEN-002
- **URL**: `/results/:scanHistoryId`
- **説明**: リンク切れ調査の結果を一覧表示する画面
- **対象ユーザー**: すべてのユーザー

## 画面の目的

- リンク切れの一覧を表示する
- フィルタリング・検索機能で結果を絞り込む
- 統計情報を表示する
- 調査結果をエクスポートする
- 詳細画面に遷移する

## レイアウト

### 画面構成

```
┌─────────────────────────────────────────┐
│           ヘッダー（戻るボタン）          │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐  │
│  │  統計情報エリア                  │  │
│  │  総リンク数 / リンク切れ数 / 率  │  │
│  └─────────────────────────────────┘  │
│                                         │
│  ┌─────────────────────────────────┐  │
│  │  フィルタ・検索エリア            │  │
│  │  [フィルタ] [検索]              │  │
│  └─────────────────────────────────┘  │
│                                         │
│  ┌─────────────────────────────────┐  │
│  │  結果テーブル                    │  │
│  │  [テーブルヘッダー]              │  │
│  │  [結果行]                        │  │
│  │  [ページネーション]               │  │
│  └─────────────────────────────────┘  │
│                                         │
│  ┌─────────────────────────────────┐  │
│  │  アクションボタン                │  │
│  │  [エクスポート] [戻る]          │  │
│  └─────────────────────────────────┘  │
│                                         │
└─────────────────────────────────────────┘
```

## 画面要素

### 要素1: 統計情報エリア

- **要素名**: 統計情報エリア
- **種類**: 情報表示エリア
- **位置**: 画面上部
- **説明**: 調査結果の統計情報を表示
- **表示内容**: 
  - 総リンク数
  - リンク切れ数
  - リンク切れ率
  - HTTPステータスコード別の分布

### 要素2: フィルタエリア

- **要素名**: フィルタエリア
- **種類**: フィルタコンポーネント
- **位置**: 統計情報エリアの下
- **説明**: 結果をフィルタリングする
- **フィルタ項目**: 
  - HTTPステータスコード（404, 500など）
  - エラー有無

### 要素3: 検索エリア

- **要素名**: 検索エリア
- **種類**: 検索入力欄
- **位置**: フィルタエリアの横
- **説明**: URL、リンク元URL、アンカーテキストで検索

### 要素4: 結果テーブル

- **要素名**: 結果テーブル
- **種類**: テーブル
- **位置**: 画面中央
- **説明**: 調査結果をテーブル形式で表示
- **カラム**: 
  - URL
  - リンク元URL
  - アンカーテキスト
  - HTTPステータスコード
  - エラーメッセージ
  - 調査日時
  - 詳細ボタン

### 要素5: ページネーション

- **要素名**: ページネーション
- **種類**: ページネーションコンポーネント
- **位置**: 結果テーブルの下
- **説明**: 大量の結果をページ分割して表示

### 要素6: エクスポートボタン

- **要素名**: エクスポートボタン
- **種類**: ボタン
- **位置**: 画面下部
- **説明**: 調査結果をCSV形式でエクスポート

## バリデーション

### 入力バリデーション

| 項目名 | バリデーション内容 | エラーメッセージ |
|-------|------------------|----------------|
| 検索文字列 | 空文字列でないか | "検索文字列を入力してください" |

## エラーハンドリング

### エラー表示方法

- エラーメッセージはモーダルダイアログで表示

### エラーメッセージ

| エラーコード | エラーメッセージ | 表示位置 |
|------------|----------------|---------|
| NOT_FOUND | "調査履歴が見つかりません" | モーダルダイアログ |
| DATABASE_ERROR | "データベースエラーが発生しました" | モーダルダイアログ |
| EXPORT_ERROR | "エクスポートに失敗しました" | モーダルダイアログ |

## 画面遷移

### 遷移元

- [メイン画面](./main-screen.md) → この画面（調査開始後）
- [調査履歴画面](./history-screen.md) → この画面（履歴選択）

### 遷移先

- この画面 → [調査結果詳細画面](./result-detail-screen.md)（詳細ボタンクリック）
- この画面 → [メイン画面](./main-screen.md)（戻るボタンクリック）

## 処理フロー

1. 画面表示時
   - `scanHistoryId`から調査結果を取得
   - 統計情報を計算して表示
   - 結果テーブルに結果を表示
2. フィルタ変更時
   - `ipc:get-scan-results` APIを呼び出し（フィルタオプション付き）
   - 結果テーブルを更新
3. 検索実行時
   - `ipc:get-scan-results` APIを呼び出し（検索オプション付き）
   - 結果テーブルを更新
4. 詳細ボタンクリック時
   - 調査結果詳細画面に遷移（結果IDを渡す）
5. エクスポートボタンクリック時
   - ファイル保存ダイアログを表示
   - `ipc:export-results` APIを呼び出し
   - エクスポート完了を通知

## 状態管理

### 画面状態

- `scanHistoryId: number` - 調査履歴ID
- `results: LinkCheckResult[]` - 調査結果
- `filterOptions: FilterOptions` - フィルタオプション
- `searchOptions: SearchOptions` - 検索オプション
- `currentPage: number` - 現在のページ番号
- `pageSize: number` - 1ページあたりの件数
- `totalPages: number` - 総ページ数

## 関連画面

- [メイン画面](./main-screen.md)
- [調査結果詳細画面](./result-detail-screen.md)
- [調査履歴画面](./history-screen.md)

